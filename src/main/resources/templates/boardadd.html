<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<form id="saveForm" method="post" autocomplete="off">
    <input type="hidden" id="id" name="id" th:if="${post != null}" th:value="${post.id}" />
    <input type="text" name="title">`
    <input type="text" name="content">
    <input type="text" name="writer">
    <input type="submit" value="제출">

</form>
<script th:inline="javascript">
    window.onload = () => {
        renderPostInfo();
    }


    // 게시글 상세정보 렌더링
    function renderPostInfo() {
        const post = [[ ${post}]];

        if (!post) {
            initCreatedDate();
            return false;
        }

        const form = document.getElementById('saveForm');
        const fields = ['id', 'title', 'content', 'writer', 'noticeYn'];
        form.isNotice.checked = post.noticeYn;
        form.createdDate.value = dayjs(post.createdDate).format('YYYY-MM-DD HH:mm');

        fields.forEach(field => {
            form[field].value = post[field];
        })
    }


    // 등록일 초기화
    function initCreatedDate() {
        document.getElementById('createdDate').value = dayjs().format('YYYY-MM-DD');
    }


    // 게시글 저장(수정)
    function savePost() {
        const form = document.getElementById('saveForm');
        const fields = [form.title, form.writer, form.content];
        const fieldNames = ['제목', '이름', '내용'];

        for (let i = 0, len = fields.length; i < len; i++) {
            isValid(fields[i], fieldNames[i]);
        }

        document.getElementById('saveBtn').disabled = true;
        form.noticeYn.value = form.isNotice.checked;
        form.action = [[ ${post == null}]] ? '/post/save.do' : '/post/update.do';
        form.submit();
    }
</script>

</body>
</html>